FROM plugins/base:linux-arm64

LABEL maintainer="Drone.IO Community <drone-dev@googlegroups.com>" \
  org.label-schema.name="Drone PyPi" \
  org.label-schema.vendor="Drone.IO Community" \
  org.label-schema.schema-version="1.0"

RUN apk add -U ca-certificates python3 \
    python3-dev gcc libc-dev libffi-dev openssl-dev git && \
    rm -rf /var/cache/apk/* && \
    python3 -m ensurepip && \
    env CRYPTOGRAPHY_DONT_BUILD_RUST=1 pip3 install --no-cache-dir --upgrade pip setuptools wheel six twine

ADD release/linux/arm64/drone-pypi /bin/
ENTRYPOINT ["/bin/drone-pypi"]
